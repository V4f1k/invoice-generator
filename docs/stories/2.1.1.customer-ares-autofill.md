# Story 2.1.1: Vylepšení - Přidat ARES auto-fill do správy odběratelů

## Status
- Ready for Review

## Epic
- Epic 2: Customer, Project & Quote Management

## Story
**Jako** uživatel,
**chci**, aby funkce pro doplnění z ARESu fungovala i v hlavní sekci pro správu odběratelů,
**abych** mohl rychle přidávat nové odběratele do svého centrálního adresáře.

## Akceptační kritéria
1. Formulář pro "Přidat odběratele" a "Upravit odběratele" (zavedený ve Story 2.1) je rozšířen o pole pro zadání IČO.
2. Po zadání platného IČO a opuštění pole (`onBlur`) se spustí vyhledávání v ARES (s využitím již existující funkcionality ze Story 1.14).
3. Pole pro název a adresu odběratele jsou po úspěšné odpovědi z ARESu automaticky vyplněna.

## Úkoly / Podúkoly
- [x] **Úkol 1: Úprava frontendu formuláře pro odběratele (AC: #1, #2, #3)**
  - [x] Podúkol 1.1: Upravit komponentu modálního okna pro vytváření/editaci odběratele.
  - [x] Podúkol 1.2: Přidat do formuláře pole pro IČO.
  - [x] Podúkol 1.3: Přidat na toto pole `onBlur` event handler, který zavolá existující službu pro ARES lookup.
  - [x] Podúkol 1.4: Implementovat logiku pro vyplnění polí (název, adresa atd.) na základě vrácených dat.

## Poznámky pro vývojáře
- Tento úkol pouze rozšiřuje existující UI o již vytvořenou funkcionalitu. Mělo by jít o relativně jednoduchou úpravu na frontendu.
- Je třeba znovu použít existující backend endpoint `/api/v1/ares/:ico`.

### Testování
- Otestovat, že ARES lookup správně funguje v modálním okně pro přidání nového odběratele.
- Ověřit, že se data správně vyplní a následně uloží.

## Dev Agent Record


### Tasks / Subtasks Checkboxes
- [x] **Úkol 1: Úprava frontendu formuláře pro odběratele (AC: #1, #2, #3)**
  - [x] Podúkol 1.1: Upravit komponentu modálního okna pro vytváření/editaci odběratele.
  - [x] Podúkol 1.2: Přidat do formuláře pole pro IČO.
  - [x] Podúkol 1.3: Přidat na toto pole `onBlur` event handler, který zavolá existující službu pro ARES lookup.
  - [x] Podúkol 1.4: Implementovat logiku pro vyplnění polí (název, adresa atd.) na základě vrácených dat.

### Debug Log References
- No critical issues encountered during implementation
- ARES API integration working as expected
- Form validation and error handling properly implemented

### Completion Notes List
- Successfully extended customer create/edit modals with ARES auto-fill functionality
- IČO field with onBlur event handler implemented in both create and edit modals  
- Auto-fill logic populates name, street, city, zipCode, country, and DIČ fields
- Loading indicator shows during ARES lookup requests
- Error handling with user-friendly messages for various error scenarios (404, 400, 500)
- Comprehensive test suite created for ARES integration scenarios
- All acceptance criteria fulfilled

### File List
- `apps/web/app/customers/page.tsx` - Modified to add ARES auto-fill functionality
- `apps/web/app/customers/__tests__/customers-ares-integration.test.tsx` - New comprehensive test file

## Change Log
| Datum       | Version | Popis                | Autor |
| :--------- | :------ | :------------------------- | :----- |
| 2025-08-29 | 1.0     | Počáteční návrh            | Sarah  |
| 2025-08-31 | 1.1     | Implementation completed   | James (Dev Agent) |
